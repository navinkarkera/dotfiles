#!/usr/bin/env bash

if [[ $# -eq 1 ]]; then
    selected=$1
else
    items=`find ~/work -maxdepth 1 -mindepth 1 -type d \( ! -iname "vm" \)`
    # items+=("$HOME/personal")
    # items+=("$HOME/work")
    selected=`echo "$items" | fzf-tmux -p`
    [[ -z $selected ]] && exit 0
fi

base="$(basename $selected)"

tmux switch-client -t $base && exit 0

tn="tmux -2 -u -f $HOME/.config/tmux/.tmux.conf new"
ta="tmux -2 -u -f $HOME/.config/tmux/.tmux.conf attach"

$tn -c $selected -d -s $base && tmux switch-client -t $base || tmux new -c $selected -A -s $dirname
